import{B as S,z as b,D as m}from"./index-CdlCrrVJ.js";const y="appSettingsV1",u={widthMargin:10,easeAllowance:2,rfSnapSeparation:4.25,ripplefoldFullness:{60:1.8,80:2,100:2.2,120:2.4},railroadStrict:!0,fabricWidthOptions:[54,108,110,118]},f=t=>({widthMargin:t.widthMargin,easeAllowance:t.easeAllowance,rfSnapSeparation:t.rfSnapSeparation,ripplefoldFullness:{...t.ripplefoldFullness},railroadStrict:t.railroadStrict,fabricWidthOptions:[...t.fabricWidthOptions]});function w(){try{const t=localStorage.getItem(y);if(!t)return f(u);const e=JSON.parse(t),s=f(u);if(typeof e.widthMargin=="number"&&(s.widthMargin=e.widthMargin),typeof e.easeAllowance=="number"&&(s.easeAllowance=e.easeAllowance),typeof e.rfSnapSeparation=="number"&&(s.rfSnapSeparation=e.rfSnapSeparation),typeof e.railroadStrict=="boolean"&&(s.railroadStrict=e.railroadStrict),e.ripplefoldFullness)for(const a of Object.keys(s.ripplefoldFullness)){const i=parseFloat(String(e.ripplefoldFullness[a]));!Number.isNaN(i)&&i>0&&(s.ripplefoldFullness[a]=i)}if(Array.isArray(e.fabricWidthOptions)){const a=[];for(const c of e.fabricWidthOptions){const l=Number(c);if(Number.isFinite(l)){const r=Math.trunc(l);r>0&&a.push(r)}}const i=Array.from(new Set(a)).sort((c,l)=>c-l);i.length&&(s.fabricWidthOptions=i)}return s}catch(t){return f(u)}}const p=S(w());b(p,t=>{try{localStorage.setItem(y,JSON.stringify(t))}catch(e){console.warn("Failed to persist settings",e)}},{deep:!0});function I(){return{state:p,reset:()=>{const e=f(u);Object.assign(p,e)},defaultSettings:f(u)}}const g="measurementSystem";function O(){try{const t=localStorage.getItem(g);if(t==="imperial"||t==="metric")return t}catch(t){}return"imperial"}const o=S({system:O()}),h=2.54,F=1/h,M=25.4,N=1/M;function _(){const t=r=>{o.system=r;try{localStorage.setItem(g,r)}catch(n){console.warn("Failed to persist measurement system",n)}},e=r=>{if(o.system==="metric"){const n=r*h;return n>=1?{value:Math.round(n*100)/100,unit:"cm"}:{value:Math.round(r*M*10)/10,unit:"mm"}}return{value:Math.round(r*100)/100,unit:"in"}},s=(r,n)=>{if(o.system==="metric"){if(n==="cm")return r*F;if(n==="mm")return r*N}return r},a=()=>o.system==="metric"?"cm":"in",i=()=>o.system==="metric"?"mm":"in",c=(r,n=2)=>{const d=e(r);return"".concat(d.value.toFixed(n)," ").concat(d.unit)},l=r=>{const n=parseFloat(r);return isNaN(n)?0:s(n,a())};return{system:m(()=>o.system),setSystem:t,fromInches:e,toInches:s,getUnitLabel:a,getSmallUnitLabel:i,formatValue:c,parseValue:l,isImperial:m(()=>o.system==="imperial"),isMetric:m(()=>o.system==="metric")}}export{I as a,_ as u};
